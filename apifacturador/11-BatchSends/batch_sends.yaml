openapi: 3.0.1
info:
  title: Batch Sends
  version: 1.0.0
servers:
  - url: https://{url_base}/api/ubl2.1
    description: Servidor de Producción / Staging
    variables:
      url_base:
        default: buho.fastura.uio.la
        description: URL base del API (sin protocolo ni /api/ubl2.1)
paths:
  /add-to-batch/invoice/{batch_token}:
    post:
      tags:
        - Batch Sends
      summary: Agregar Factura al Lote
      parameters:
        - in: path
          name: batch_token
          schema:
            type: string
          required: true
          description: Token identificador del lote (ej. 'batch1')
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              example:
                number: 990000210
                type_document_id: 1
                date: "2020-12-18"
                time: "04:08:12"
                resolution_number: "18760000001"
                prefix: "SETP"
                establishment_name: "TORRE SOFTWARE"
                sendmail: true
                customer:
                  identification_number: 900166483
                  dv: 1
                  name: "INVERSIONES DAVAL SAS"
                  phone: "3103891693"
                  address: "CLL 4 NRO 33-90"
                  email: "alexanderobandolondono@gmail.com"
                  merchant_registration: "0000000-00"
                  type_document_identification_id: 6
                  type_organization_id: 1
                  type_liability_id: 7
                  municipality_id: 822
                  type_regime_id: 1
                payment_form:
                  payment_form_id: 2
                  payment_method_id: 30
                  payment_due_date: "2021-01-18"
                  duration_measure: "30"
                allowance_charges:
                  - discount_id: 1
                    charge_indicator: false
                    allowance_charge_reason: "DESCUENTO GENERAL"
                    amount: "0.00"
                    base_amount: "840336.13"
                legal_monetary_totals:
                  line_extension_amount: "840336.13"
                  tax_exclusive_amount: "840336.13"
                  tax_inclusive_amount: "1000000.00"
                  allowance_total_amount: "0.00"
                  charge_total_amount: "0.00"
                  payable_amount: "1000000.00"
                tax_totals:
                  - tax_id: 1
                    tax_amount: "159663.86"
                    percent: "19"
                    taxable_amount: "840336.13"
                invoice_lines:
                  - unit_measure_id: 70
                    invoiced_quantity: "1"
                    line_extension_amount: "840336.13"
                    free_of_charge_indicator: false
                    allowance_charges:
                      - charge_indicator: false
                        allowance_charge_reason: "DESCUENTO GENERAL"
                        amount: "0.00"
                        base_amount: "1000000.00"
                    tax_totals:
                      - tax_id: 1
                        tax_amount: "159663.86"
                        taxable_amount: "840336.13"
                        percent: "19.00"
                    description: "COMISION POR SERVICIOS"
                    code: "COMISION"
                    type_item_identification_id: 4
                    price_amount: "840336.13"
                    base_quantity: "1"
      responses:
        '200':
          description: Factura agregada al lote correctamente
          content:
            application/json:
              schema:
                type: object

  /add-to-batch/credit-note/{batch_token}:
    post:
      tags:
        - Batch Sends
      summary: Agregar Nota Crédito al Lote
      parameters:
        - in: path
          name: batch_token
          schema:
            type: string
          required: true
          description: Token identificador del lote
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              example:
                billing_reference:
                  number: "990010016"
                  uuid: "31fb5b49826c9ee845f9cb3c8f52b3d96d98ccdc2732e2063273836b634f26f9df9d26cf83dfbc045751c8d445ee3277"
                  issue_date: "2020-07-30"
                discrepancyresponsecode: 2
                discrepancyresponsedescription: "PRUEBA DE MOTIVO NOTA CREDITO"
                number: 754
                type_document_id: 4
                date: "2020-07-30"
                time: "06:00:13"
                customer:
                  identification_number: 900166483
                  dv: 1
                  name: "INVERSIONES DAVAL SAS"
                  phone: "3103891693"
                  address: "CLL 4 NRO 33-90"
                  email: "alexanderobandolondono@gmail.com"
                  merchant_registration: "0000000-00"
                  type_document_identification_id: 6
                  type_organization_id: 1
                  municipality_id: 822
                  type_regime_id: 1
                tax_totals:
                  - tax_id: 1
                    tax_amount: "0.00"
                    taxable_amount: "0.00"
                    percent: "0.00"
                legal_monetary_totals:
                  line_extension_amount: "45000.00"
                  tax_exclusive_amount: "0"
                  tax_inclusive_amount: "45000.00"
                  allowance_total_amount: "0"
                  charge_total_amount: "0.00"
                  payable_amount: "45000.00"
                credit_note_lines:
                  - unit_measure_id: 70
                    invoiced_quantity: "1"
                    line_extension_amount: "45000.00"
                    free_of_charge_indicator: false
                    allowance_charges:
                      - charge_indicator: false
                        allowance_charge_reason: "DESCUENTO GENERAL"
                        amount: "0.00"
                        base_amount: "45000.00"
                    tax_totals:
                      - tax_id: 1
                        tax_amount: "0.00"
                        taxable_amount: "0.00"
                        percent: "0.00"
                    description: "PRUEBA NOTA CONTABLE ELECTRONICA"
                    code: "001NOTA"
                    type_item_identification_id: 4
                    price_amount: "45000"
                    base_quantity: "1"
      responses:
        '200':
          description: Nota crédito agregada al lote correctamente
          content:
            application/json:
              schema:
                type: object

  /add-to-batch/debit-note/{batch_token}:
    post:
      tags:
        - Batch Sends
      summary: Agregar Nota Débito al Lote
      parameters:
        - in: path
          name: batch_token
          schema:
            type: string
          required: true
          description: Token identificador del lote
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              example:
                billing_reference:
                  number: "SETP990000208"
                  uuid: "8a65e3a8a2652a66e82b8cafdbcb036ffa4cdb4140b4eaf7596914fc183af70a6fdbab139a848fa6a745d02cd0a4be13"
                  issue_date: "2020-12-17"
                number: 24
                type_document_id: 5
                date: "2020-12-17"
                time: "04:10:09"
                notes: "PRUEBA DE NOTA DEBITO"
                customer:
                  identification_number: 900166483
                  dv: 1
                  name: "INVERSIONES DAVAL SAS"
                  phone: "3103891693"
                  address: "CLL 4 NRO 33-90"
                  email: "alexanderobandolondono@gmail.com"
                  merchant_registration: "0000000-00"
                  type_document_identification_id: 6
                  type_organization_id: 1
                  municipality_id: 822
                  type_regime_id: 1
                tax_totals:
                  - tax_id: 1
                    tax_amount: "0.00"
                    taxable_amount: "0.00"
                    percent: "0.00"
                requested_monetary_totals:
                  line_extension_amount: "32000.00"
                  tax_exclusive_amount: "0"
                  tax_inclusive_amount: "32000.00"
                  allowance_total_amount: "0"
                  charge_total_amount: "0.00"
                  payable_amount: "32000.00"
                debit_note_lines:
                  - unit_measure_id: 70
                    invoiced_quantity: "1"
                    line_extension_amount: "32000.00"
                    free_of_charge_indicator: false
                    allowance_charges:
                      - charge_indicator: false
                        allowance_charge_reason: "DESCUENTO GENERAL"
                        amount: "0.00"
                        base_amount: "32000.00"
                    tax_totals:
                      - tax_id: 1
                        tax_amount: "0.00"
                        taxable_amount: "0.00"
                        percent: "0.00"
                    description: "PRUEBA DE NOTA DEBITO ELECTRONICA"
                    code: "001NOTA"
                    type_item_identification_id: 4
                    price_amount: "32000"
                    base_quantity: "1"
      responses:
        '200':
          description: Nota débito agregada al lote correctamente
          content:
            application/json:
              schema:
                type: object

  /add-to-batch/invoice-contingency/{batch_token}:
    post:
      tags:
        - Batch Sends
      summary: Agregar Factura de Contingencia al Lote
      parameters:
        - in: path
          name: batch_token
          schema:
            type: string
          required: true
          description: Token identificador del lote
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              example:
                number: 990000475
                dv: 2
                type_document_id: 3
                AdditionalDocumentReferenceID: "CN34"
                AdditionalDocumentReferenceDate: "2019-12-20"
                AdditionalDocumentReferenceTypeDocument: "01"
                date: "2019-12-23"
                time: "06:08:12"
                resolution_number: "18760000001"
                prefix: "SETP"
                establishment_name: "TORRE SOFTWARE"
                customer:
                  identification_number: 89008003
                  name: "ALEXANDER OBANDO LONDONO"
                  phone: "3103891693"
                  address: "BRR LIMONAR MZ 6 CS 3 ET 1"
                  email: "alexander_obando@hotmail.com"
                  merchant_registration: "0000-00"
                  type_document_identification_id: 3
                  type_organization_id: 2
                  municipality_id: 149
                  type_regime_id: 2
                payment_form:
                  payment_form_id: 1
                  payment_method_id: 10
                  payment_due_date: "2019-12-23"
                  duration_measure: "0"
                allowance_charges:
                  - discount_id: 1
                    charge_indicator: false
                    allowance_charge_reason: "DESCUENTO GENERAL"
                    amount: "0.00"
                    base_amount: "840336.13"
                legal_monetary_totals:
                  line_extension_amount: "840336.13"
                  tax_exclusive_amount: "840336.13"
                  tax_inclusive_amount: "1000000.00"
                  allowance_total_amount: "0.00"
                  charge_total_amount: "0.00"
                  payable_amount: "1000000.00"
                tax_totals:
                  - tax_id: 1
                    tax_amount: "159663.86"
                    percent: "19"
                    taxable_amount: "840336.13"
                invoice_lines:
                  - unit_measure_id: 70
                    invoiced_quantity: "1"
                    line_extension_amount: "840336.13"
                    free_of_charge_indicator: false
                    allowance_charges:
                      - charge_indicator: false
                        allowance_charge_reason: "DESCUENTO GENERAL"
                        amount: "0.00"
                        base_amount: "1000000.00"
                    tax_totals:
                      - tax_id: 1
                        tax_amount: "159663.86"
                        taxable_amount: "840336.13"
                        percent: "19.00"
                    description: "COMISION POR SERVICIOS"
                    code: "COMISION"
                    type_item_identification_id: 4
                    price_amount: "840336.13"
                    base_quantity: "1"
      responses:
        '200':
          description: Factura de contingencia agregada al lote correctamente
          content:
            application/json:
              schema:
                type: object

  /add-to-batch/invoice-aiu/{batch_token}:
    post:
      tags:
        - Batch Sends
      summary: Agregar Factura AIU al Lote
      parameters:
        - in: path
          name: batch_token
          schema:
            type: string
          required: true
          description: Token identificador del lote
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              example:
                number: 990000523
                dv: 2
                type_document_id: 1
                date: "2020-03-28"
                time: "09:44:45"
                resolution_number: "18760000001"
                prefix: "SETP"
                establishment_name: "TORRE SOFTWARE"
                notes: "SIN OBSERVACIONES"
                noteAIU: "PRUEBA DE CONTRATO AIU"
                customer:
                  identification_number: 89008003
                  name: "ALEXANDER OBANDO LONDONO"
                  phone: "3103891693"
                  address: "BRR LIMONAR MZ 6 CS 3 ET 1"
                  email: "alexander_obando@hotmail.com"
                  merchant_registration: "0000-00"
                  type_document_identification_id: 3
                  type_organization_id: 2
                  municipality_id: 149
                  type_regime_id: 2
                payment_form:
                  payment_form_id: 1
                  payment_method_id: 10
                  payment_due_date: "2020-03-28"
                  duration_measure: "0"
                allowance_charges:
                  - discount_id: 1
                    charge_indicator: false
                    allowance_charge_reason: "DESCUENTO GENERAL"
                    amount: "0.00"
                    base_amount: "1704201.68"
                legal_monetary_totals:
                  line_extension_amount: "1704201.68"
                  tax_exclusive_amount: "1704201.68"
                  tax_inclusive_amount: "1800000.00"
                  allowance_total_amount: "0.00"
                  charge_total_amount: "0.00"
                  payable_amount: "1800000.00"
                tax_totals:
                  - tax_id: 1
                    tax_amount: "0.00"
                    percent: "0"
                    taxable_amount: "1200000.00"
                  - tax_id: 1
                    tax_amount: "95798.32"
                    percent: "19"
                    taxable_amount: "504201.68"
                invoice_lines:
                  - unit_measure_id: 70
                    invoiced_quantity: "1"
                    line_extension_amount: "600000.00"
                    free_of_charge_indicator: false
                    allowance_charges:
                      - charge_indicator: false
                        allowance_charge_reason: "DESCUENTO GENERAL"
                        amount: "0.00"
                        base_amount: "600000.00"
                    tax_totals:
                      - tax_id: 1
                        tax_amount: "0.00"
                        taxable_amount: "600000.00"
                        percent: "0.00"
                    description: "Administración"
                    code: "ADMINIST"
                    type_item_identification_id: 4
                    price_amount: "600000.00"
                    base_quantity: "1"
                  - unit_measure_id: 70
                    invoiced_quantity: "1"
                    line_extension_amount: "600000.00"
                    free_of_charge_indicator: false
                    allowance_charges:
                      - charge_indicator: false
                        allowance_charge_reason: "DESCUENTO GENERAL"
                        amount: "0.00"
                        base_amount: "600000.00"
                    tax_totals:
                      - tax_id: 1
                        tax_amount: "0.00"
                        taxable_amount: "600000.00"
                        percent: "0.00"
                    description: "Imprevisto"
                    code: "IMPREVIS"
                    type_item_identification_id: 4
                    price_amount: "600000.00"
                    base_quantity: "1"
                  - unit_measure_id: 70
                    invoiced_quantity: "1"
                    line_extension_amount: "504201.68"
                    free_of_charge_indicator: false
                    allowance_charges:
                      - charge_indicator: false
                        allowance_charge_reason: "DESCUENTO GENERAL"
                        amount: "0.00"
                        base_amount: "600000.00"
                    tax_totals:
                      - tax_id: 1
                        tax_amount: "95798.32"
                        taxable_amount: "504201.68"
                        percent: "19.00"
                    description: "Utilidad"
                    code: "UTILIDAD"
                    type_item_identification_id: 4
                    price_amount: "504201.68"
                    base_quantity: "1"
      responses:
        '200':
          description: Factura AIU agregada al lote correctamente
          content:
            application/json:
              schema:
                type: object

  /add-to-batch/invoice-mandate/{batch_token}:
    post:
      tags:
        - Batch Sends
      summary: Agregar Factura Mandato al Lote
      parameters:
        - in: path
          name: batch_token
          schema:
            type: string
          required: true
          description: Token identificador del lote
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              example:
                number: 990000465
                dv: 2
                type_document_id: 1
                date: "2020-01-03"
                time: "06:44:45"
                resolution_number: "18760000001"
                prefix: "SETP"
                establishment_name: "TORRE SOFTWARE"
                notes: "SIN OBSERVACIONES"
                customer:
                  identification_number: 89008003
                  dv: 2
                  name: "ALEXANDER OBANDO LONDONO"
                  phone: "3103891693"
                  address: "BRR LIMONAR MZ 6 CS 3 ET 1"
                  email: "alexander_obando@hotmail.com"
                  merchant_registration: "0000-00"
                  type_document_identification_id: 6
                  type_organization_id: 2
                  municipality_id: 149
                  type_regime_id: 2
                payment_form:
                  payment_form_id: 1
                  payment_method_id: 10
                  payment_due_date: "2020-01-03"
                  duration_measure: "0"
                allowance_charges:
                  - discount_id: 1
                    charge_indicator: false
                    allowance_charge_reason: "DESCUENTO GENERAL"
                    amount: "0.00"
                    base_amount: "1704201.68"
                legal_monetary_totals:
                  line_extension_amount: "1704201.68"
                  tax_exclusive_amount: "1704201.68"
                  tax_inclusive_amount: "1800000.00"
                  allowance_total_amount: "0.00"
                  charge_total_amount: "0.00"
                  payable_amount: "1800000.00"
                tax_totals:
                  - tax_id: 1
                    tax_amount: "0.00"
                    percent: "0"
                    taxable_amount: "1200000.00"
                  - tax_id: 1
                    tax_amount: "95798.32"
                    percent: "19"
                    taxable_amount: "504201.68"
                invoice_lines:
                  - unit_measure_id: 70
                    invoiced_quantity: "1"
                    line_extension_amount: "600000.00"
                    free_of_charge_indicator: false
                    allowance_charges:
                      - charge_indicator: false
                        allowance_charge_reason: "DESCUENTO GENERAL"
                        amount: "0.00"
                        base_amount: "600000.00"
                    tax_totals:
                      - tax_id: 1
                        tax_amount: "0.00"
                        taxable_amount: "600000.00"
                        percent: "0.00"
                    description: "PRUEBA MANDATO"
                    code: "PRUEBA1"
                    type_item_identification_id: 4
                    price_amount: "600000.00"
                    base_quantity: "1"
                  - unit_measure_id: 70
                    invoiced_quantity: "1"
                    line_extension_amount: "600000.00"
                    free_of_charge_indicator: false
                    allowance_charges:
                      - charge_indicator: false
                        allowance_charge_reason: "DESCUENTO GENERAL"
                        amount: "0.00"
                        base_amount: "600000.00"
                    tax_totals:
                      - tax_id: 1
                        tax_amount: "0.00"
                        taxable_amount: "600000.00"
                        percent: "0.00"
                    description: "PRUEBA MANDATO"
                    code: "PRUEBA2"
                    type_item_identification_id: 4
                    price_amount: "600000.00"
                    base_quantity: "1"
                  - unit_measure_id: 70
                    invoiced_quantity: "1"
                    line_extension_amount: "504201.68"
                    free_of_charge_indicator: false
                    allowance_charges:
                      - charge_indicator: false
                        allowance_charge_reason: "DESCUENTO GENERAL"
                        amount: "0.00"
                        base_amount: "600000.00"
                    tax_totals:
                      - tax_id: 1
                        tax_amount: "95798.32"
                        taxable_amount: "504201.68"
                        percent: "19.00"
                    description: "PRUEBA MANDATO"
                    agentparty: 900468658
                    agentparty_dv: 1
                    code: "PRUEBA3"
                    type_item_identification_id: 4
                    price_amount: "504201.68"
                    base_quantity: "1"
      responses:
        '200':
          description: Factura mandato agregada al lote correctamente
          content:
            application/json:
              schema:
                type: object

  /add-to-batch/invoice-export/{batch_token}:
    post:
      tags:
        - Batch Sends
      summary: Agregar Factura de Exportación al Lote
      parameters:
        - in: path
          name: batch_token
          schema:
            type: string
          required: true
          description: Token identificador del lote
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              example:
                number: 990000034
                type_document_id: 2
                date: "2020-09-15"
                time: "04:25:44"
                resolution_number: "18760000001"
                prefix: "SETP"
                establishment_name: "TORRE SOFTWARE"
                notes: "SIN OBSERVACIONES"
                idcurrency: 149
                calculationrate: 3750
                calculationratedate: "2020-09-15"
                sendmail: true
                customer:
                  identification_number: "FR42128XD090"
                  name: "BLANCA NUBIA ALVAREZ ALZATE "
                  phone: 3148931130
                  address: "CR 14 BIS 31 B 37 BRR SAN NICOLAS"
                  email: "blancanubiaa@hotmail.com"
                  merchant_registration: "0000-00"
                  type_document_identification_id: 8
                  type_organization_id: 2
                  country_id: 65
                  municipality_name: "MIAMI"
                  state_name: "FLORIDA"
                  type_liability_id: 117
                  type_regime_id: 2
                deliveryterms:
                  special_terms: "COSTO SEGURO Y FLETE"
                  loss_risk_responsibility_code: "CIF"
                  loss_risk: "COSTO SEGURO Y FLETE"
                payment_form:
                  payment_form_id: 2
                  payment_method_id: 10
                  payment_due_date: "2020-10-15"
                  duration_measure: "30"
                allowance_charges:
                  - discount_id: 10
                    charge_indicator: false
                    allowance_charge_reason: "DESCUENTO GENERAL"
                    amount: "0.00"
                    base_amount: "15840.00"
                  - charge_indicator: true
                    allowance_charge_reason: "CARGO POR FLETES/FREIGHT CHARGE"
                    amount: "200.00"
                    base_amount: "15840.00"
                legal_monetary_totals:
                  line_extension_amount: "15840.00"
                  tax_exclusive_amount: "15840.00"
                  tax_inclusive_amount: "15840.00"
                  allowance_total_amount: "0.00"
                  charge_total_amount: "200.00"
                  payable_amount: "16040.00"
                tax_totals:
                  - tax_id: 1
                    tax_amount: "0.00"
                    percent: "0"
                    taxable_amount: "15840.00"
                invoice_lines:
                  - unit_measure_id: 70
                    invoiced_quantity: "5.00"
                    line_extension_amount: "4950.00"
                    free_of_charge_indicator: false
                    allowance_charges:
                      - charge_indicator: false
                        allowance_charge_reason: "DESCUENTO GENERAL"
                        amount: "0.00"
                        base_amount: "4950.00"
                    tax_totals:
                      - tax_id: 1
                        tax_amount: "0.00"
                        taxable_amount: "4950.00"
                        percent: "0.00"
                    description: "LEGGINS DE DAMA REF 1032"
                    brandname: "FULLFIT"
                    modelname: "1032"
                    code: "1032"
                    type_item_identification_id: 4
                    price_amount: "990.00"
                    base_quantity: "5.00"
                  - unit_measure_id: 70
                    invoiced_quantity: "6.00"
                    line_extension_amount: "5940.00"
                    free_of_charge_indicator: false
                    allowance_charges:
                      - charge_indicator: false
                        allowance_charge_reason: "DESCUENTO GENERAL"
                        amount: "0.00"
                        base_amount: "5940.00"
                    tax_totals:
                      - tax_id: 1
                        tax_amount: "0.00"
                        taxable_amount: "5940.00"
                        percent: "0.00"
                    description: "LEGGINS DE DAMA REF 1087"
                    brandname: "FULLFIT"
                    modelname: "1087"
                    code: "1087"
                    type_item_identification_id: 4
                    price_amount: "990.00"
                    base_quantity: "6.00"
                  - unit_measure_id: 70
                    invoiced_quantity: "5.00"
                    line_extension_amount: "4950.00"
                    free_of_charge_indicator: false
                    allowance_charges:
                      - charge_indicator: false
                        allowance_charge_reason: "DESCUENTO GENERAL"
                        amount: "0.00"
                        base_amount: "4950.00"
                    tax_totals:
                      - tax_id: 1
                        tax_amount: "0.00"
                        taxable_amount: "4950.00"
                        percent: "0.00"
                    description: "LEGGINS DE DAMA REF 1088"
                    brandname: "FULLFIT"
                    modelname: "1088"
                    code: "1088"
                    type_item_identification_id: 4
                    price_amount: "990.00"
                    base_quantity: "5.00"
      responses:
        '200':
          description: Factura de exportación agregada al lote correctamente
          content:
            application/json:
              schema:
                type: object

  /send-batch/{batch_token}:
    post:
      tags:
        - Batch Sends
      summary: Enviar Lote
      description: Envía todos los documentos acumulados en el lote especificado.
      parameters:
        - in: path
          name: batch_token
          schema:
            type: string
          required: true
          description: Token identificador del lote
      responses:
        '200':
          description: Lote enviado correctamente
          content:
            application/json:
              schema:
                type: object
